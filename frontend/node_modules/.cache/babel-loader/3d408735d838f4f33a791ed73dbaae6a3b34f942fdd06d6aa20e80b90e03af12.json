{"ast":null,"code":"import _objectSpread from\"C:/Users/amy gee/Desktop/Sweet Bite Bakery System/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// src/pages/Notifications.js\nimport React,{useEffect,useState}from\"react\";import api from\"../api/api\";import{useAuth}from\"../context/AuthContext\";import toast from\"react-hot-toast\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Notifications(){const{user}=useAuth();const[notes,setNotes]=useState([]);const[loading,setLoading]=useState(true);useEffect(()=>{if(!(user!==null&&user!==void 0&&user.id))return setLoading(false);setLoading(true);api.get(\"/notifications/\".concat(user.id)).then(res=>{// backend returns either array or { data: [] }\nconst data=res.data.data||res.data;setNotes(Array.isArray(data)?data:[]);}).catch(err=>{console.error(\"Error fetching notifications:\",err);toast.error(\"Failed to load notifications\");}).finally(()=>setLoading(false));},[user]);async function markAsRead(notificationId){// optimistic UI\nsetNotes(prev=>prev.map(n=>n.id===notificationId?_objectSpread(_objectSpread({},n),{},{read_at:new Date().toISOString()}):n));try{await api.patch(\"/notifications/\".concat(notificationId,\"/read\"));toast.success(\"Marked as read\");}catch(err){console.error(\"Failed to mark read:\",err);toast.error(\"Could not mark as read\");// revert optimistic change (simple refetch)\napi.get(\"/notifications/\".concat(user.id)).then(res=>setNotes(res.data.data||res.data)).catch(()=>{});}}if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center h-screen bg-gradient-to-b from-pink-50 to-pink-100\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-5xl animate-bounce\",children:\"\\uD83D\\uDD14\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-3 text-pink-600 font-semibold animate-pulse\",children:\"Loading notifications...\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen p-6 bg-pink-50\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-semibold text-center text-pink-600 mb-4\",children:\"\\uD83D\\uDD14 Notifications\"}),notes.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl text-center text-[#d77fa1] mb-8\",children:\"No notifications yet.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4 max-w-3xl\",children:notes.map(n=>{var _n$data;return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 rounded-xl bg-white shadow flex justify-between items-start \".concat(n.read_at?\"opacity-60\":\"\"),children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600 mb-1\",children:new Date(n.created_at).toLocaleString()}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-800\",children:((_n$data=n.data)===null||_n$data===void 0?void 0:_n$data.message)||n.data&&JSON.stringify(n.data)||n.type})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col items-end gap-2\",children:n.read_at?/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-green-600\",children:\"Read\"}):/*#__PURE__*/_jsx(\"button\",{onClick:()=>markAsRead(n.id),className:\"text-sm bg-pink-600 text-white px-3 py-1 rounded-lg\",children:\"Mark read\"})})]},n.id);})})]});}","map":{"version":3,"names":["React","useEffect","useState","api","useAuth","toast","jsx","_jsx","jsxs","_jsxs","Notifications","user","notes","setNotes","loading","setLoading","id","get","concat","then","res","data","Array","isArray","catch","err","console","error","finally","markAsRead","notificationId","prev","map","n","_objectSpread","read_at","Date","toISOString","patch","success","className","children","length","_n$data","created_at","toLocaleString","message","JSON","stringify","type","onClick"],"sources":["C:/Users/amy gee/Desktop/Sweet Bite Bakery System/frontend/src/pages/Notifications.js"],"sourcesContent":["// src/pages/Notifications.js\nimport React, { useEffect, useState } from \"react\";\nimport api from \"../api/api\";\nimport { useAuth } from \"../context/AuthContext\";\nimport toast from \"react-hot-toast\";\n\nexport default function Notifications() {\n  const { user } = useAuth();\n  const [notes, setNotes] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    if (!user?.id) return setLoading(false);\n\n    setLoading(true);\n    api.get(`/notifications/${user.id}`)\n      .then((res) => {\n        // backend returns either array or { data: [] }\n        const data = res.data.data || res.data;\n        setNotes(Array.isArray(data) ? data : []);\n      })\n      .catch((err) => {\n        console.error(\"Error fetching notifications:\", err);\n        toast.error(\"Failed to load notifications\");\n      })\n      .finally(() => setLoading(false));\n  }, [user]);\n\n  async function markAsRead(notificationId) {\n    // optimistic UI\n    setNotes((prev) => prev.map(n => n.id === notificationId ? { ...n, read_at: new Date().toISOString() } : n));\n    try {\n      await api.patch(`/notifications/${notificationId}/read`);\n      toast.success(\"Marked as read\");\n    } catch (err) {\n      console.error(\"Failed to mark read:\", err);\n      toast.error(\"Could not mark as read\");\n      // revert optimistic change (simple refetch)\n      api.get(`/notifications/${user.id}`)\n        .then((res) => setNotes(res.data.data || res.data))\n        .catch(() => {});\n    }\n  }\n\n  if (loading) {\n  return (\n    <div className=\"flex flex-col items-center justify-center h-screen bg-gradient-to-b from-pink-50 to-pink-100\">\n        <div className=\"text-5xl animate-bounce\">ðŸ””</div>\n        <p className=\"mt-3 text-pink-600 font-semibold animate-pulse\">\n          Loading notifications...\n        </p>\n      </div>\n  );\n}\n\n\n  return (\n    <div className=\"min-h-screen p-6 bg-pink-50\">\n      <h1 className=\"text-2xl font-semibold text-center text-pink-600 mb-4\">ðŸ”” Notifications</h1>\n\n      {notes.length === 0 ? (\n        <p className=\"text-3xl text-center text-[#d77fa1] mb-8\">No notifications yet.</p>\n      ) : (\n        <div className=\"space-y-4 max-w-3xl\">\n          {notes.map((n) => (\n            <div key={n.id} className={`p-4 rounded-xl bg-white shadow flex justify-between items-start ${n.read_at ? \"opacity-60\" : \"\"}`}>\n              <div>\n                <div className=\"text-sm text-gray-600 mb-1\">{new Date(n.created_at).toLocaleString()}</div>\n                <div className=\"text-gray-800\">{n.data?.message || (n.data && JSON.stringify(n.data)) || n.type}</div>\n              </div>\n\n              <div className=\"flex flex-col items-end gap-2\">\n                {n.read_at ? (\n                  <span className=\"text-xs text-green-600\">Read</span>\n                ) : (\n                  <button\n                    onClick={() => markAsRead(n.id)}\n                    className=\"text-sm bg-pink-600 text-white px-3 py-1 rounded-lg\"\n                  >\n                    Mark read\n                  </button>\n                )}\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}