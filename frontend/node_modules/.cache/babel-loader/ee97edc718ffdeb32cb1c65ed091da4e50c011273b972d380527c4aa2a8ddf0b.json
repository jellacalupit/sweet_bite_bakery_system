{"ast":null,"code":"// src/App.js\nimport React from\"react\";import{BrowserRouter as Router,Routes,Route,Navigate,Outlet,useLocation}from\"react-router-dom\";import{Toaster}from\"react-hot-toast\";import AdminDashboard from\"./pages/admin/AdminDashboard\";import AdminProducts from\"./pages/admin/AdminProducts\";import Navbar from\"./components/Navbar\";import Home from\"./pages/Home\";import Products from\"./pages/Products\";import Checkout from\"./pages/Checkout\";import Orders from\"./pages/Orders\";import Notifications from\"./pages/Notifications\";import Profile from\"./pages/Profile\";import Login from\"./pages/Login\";import Register from\"./pages/Register\";import{useAuth}from\"./context/AuthContext\";import{SidebarProvider}from\"./context/SidebarContext\";// Loading screen component\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function LoadingScreen(){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-pink-50 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-[#B3611B] mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Loading...\"})]})});}// PublicRoute wrapper (prevents logged-in users from seeing login/register)\nfunction PublicRoute(_ref){let{children}=_ref;return children?children:/*#__PURE__*/_jsx(Outlet,{});}// Admin-only route\nfunction AdminRoute(_ref2){let{children}=_ref2;const{user,loading}=useAuth();if(loading)return null;if(!user||user.role!==\"admin\"){console.warn(\"❌ User is not admin. Redirecting to login.\");return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",replace:true});}return children?children:/*#__PURE__*/_jsx(Outlet,{});}// Customer-only route (case-insensitive role check)\nfunction CustomerRoute(_ref3){let{children}=_ref3;const{user,loading}=useAuth();const role=((user===null||user===void 0?void 0:user.role)||\"\").toLowerCase();if(loading)return null;if(!user||role!==\"customer\"){console.warn(\"❌ User is not customer. Redirecting to login.\");return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",replace:true});}return children?children:/*#__PURE__*/_jsx(Outlet,{});}export default function App(){const{loading}=useAuth();// Show loading screen while checking authentication\nif(loading){return/*#__PURE__*/_jsx(LoadingScreen,{});}return/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(SidebarProvider,{children:[/*#__PURE__*/_jsx(AppContent,{}),/*#__PURE__*/_jsx(Toaster,{position:\"top-center\",toastOptions:{duration:2500,style:{background:\"#f472b6\",color:\"#fff\",borderRadius:\"10px\"}}})]})});}// Main app content that lives inside the Router (so it can use useLocation)\nfunction AppContent(){const{user}=useAuth();const location=useLocation();const role=((user===null||user===void 0?void 0:user.role)||\"\").toLowerCase();// Hide navbar on auth pages and for admin users\nconst isAuthPage=location.pathname===\"/login\"||location.pathname===\"/register\";const showCustomerNavbar=user&&role===\"customer\"&&!isAuthPage;console.log(\"Current user role in App:\",user===null||user===void 0?void 0:user.role,\"normalized:\",role,\"path:\",location.pathname);return/*#__PURE__*/_jsxs(_Fragment,{children:[showCustomerNavbar&&/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsxs(Route,{element:/*#__PURE__*/_jsx(PublicRoute,{}),children:[/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(Login,{})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:/*#__PURE__*/_jsx(Register,{})})]}),/*#__PURE__*/_jsxs(Route,{element:/*#__PURE__*/_jsx(AdminRoute,{}),children:[/*#__PURE__*/_jsx(Route,{path:\"/admin/dashboard\",element:/*#__PURE__*/_jsx(AdminDashboard,{})}),/*#__PURE__*/_jsx(Route,{path:\"/admin/products\",element:/*#__PURE__*/_jsx(AdminProducts,{})})]}),/*#__PURE__*/_jsxs(Route,{element:/*#__PURE__*/_jsx(CustomerRoute,{}),children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{path:\"/home\",element:/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{path:\"/products\",element:/*#__PURE__*/_jsx(Products,{})}),/*#__PURE__*/_jsx(Route,{path:\"/checkout\",element:/*#__PURE__*/_jsx(Checkout,{})}),/*#__PURE__*/_jsx(Route,{path:\"/orders\",element:/*#__PURE__*/_jsx(Orders,{})}),/*#__PURE__*/_jsx(Route,{path:\"/notifications\",element:/*#__PURE__*/_jsx(Notifications,{})}),/*#__PURE__*/_jsx(Route,{path:\"/profile\",element:/*#__PURE__*/_jsx(Profile,{})})]}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:user?user.role===\"admin\"?/*#__PURE__*/_jsx(Navigate,{to:\"/admin/dashboard\",replace:true}):/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true}):/*#__PURE__*/_jsx(Navigate,{to:\"/login\",replace:true})})]})]});}","map":{"version":3,"names":["React","BrowserRouter","Router","Routes","Route","Navigate","Outlet","useLocation","Toaster","AdminDashboard","AdminProducts","Navbar","Home","Products","Checkout","Orders","Notifications","Profile","Login","Register","useAuth","SidebarProvider","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","LoadingScreen","className","children","PublicRoute","_ref","AdminRoute","_ref2","user","loading","role","console","warn","to","replace","CustomerRoute","_ref3","toLowerCase","App","AppContent","position","toastOptions","duration","style","background","color","borderRadius","location","isAuthPage","pathname","showCustomerNavbar","log","element","path"],"sources":["C:/Users/amy gee/Desktop/Sweet Bite Bakery System/frontend/src/App.js"],"sourcesContent":["// src/App.js\nimport React from \"react\";\nimport {\n  BrowserRouter as Router,\n  Routes,\n  Route,\n  Navigate,\n  Outlet,\n  useLocation,\n} from \"react-router-dom\";\nimport { Toaster } from \"react-hot-toast\";\n\nimport AdminDashboard from \"./pages/admin/AdminDashboard\";\nimport AdminProducts from \"./pages/admin/AdminProducts\";\nimport Navbar from \"./components/Navbar\";\nimport Home from \"./pages/Home\";\nimport Products from \"./pages/Products\";\nimport Checkout from \"./pages/Checkout\";\nimport Orders from \"./pages/Orders\";\nimport Notifications from \"./pages/Notifications\";\nimport Profile from \"./pages/Profile\";\nimport Login from \"./pages/Login\";\nimport Register from \"./pages/Register\";\n\nimport { useAuth } from \"./context/AuthContext\";\nimport { SidebarProvider } from \"./context/SidebarContext\";\n\n// Loading screen component\nfunction LoadingScreen() {\n  return (\n    <div className=\"min-h-screen bg-pink-50 flex items-center justify-center\">\n      <div className=\"text-center\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-[#B3611B] mx-auto mb-4\"></div>\n        <p className=\"text-gray-600\">Loading...</p>\n      </div>\n    </div>\n  );\n}\n\n// PublicRoute wrapper (prevents logged-in users from seeing login/register)\nfunction PublicRoute({ children }) {\n  return children ? children : <Outlet />;\n}\n\n// Admin-only route\nfunction AdminRoute({ children }) {\n  const { user, loading } = useAuth();\n  if (loading) return null;\n  if (!user || user.role !== \"admin\") {\n    console.warn(\"❌ User is not admin. Redirecting to login.\");\n    return <Navigate to=\"/login\" replace />;\n  }\n  return children ? children : <Outlet />;\n}\n\n// Customer-only route (case-insensitive role check)\nfunction CustomerRoute({ children }) {\n  const { user, loading } = useAuth();\n  const role = (user?.role || \"\").toLowerCase();\n  if (loading) return null;\n  if (!user || role !== \"customer\") {\n    console.warn(\"❌ User is not customer. Redirecting to login.\");\n    return <Navigate to=\"/login\" replace />;\n  }\n  return children ? children : <Outlet />;\n}\n\nexport default function App() {\n  const { loading } = useAuth();\n\n  // Show loading screen while checking authentication\n  if (loading) {\n    return <LoadingScreen />;\n  }\n\n  return (\n    <Router>\n      <SidebarProvider>\n        <AppContent />\n        <Toaster\n          position=\"top-center\"\n          toastOptions={{\n            duration: 2500,\n            style: { background: \"#f472b6\", color: \"#fff\", borderRadius: \"10px\" },\n          }}\n        />\n      </SidebarProvider>\n    </Router>\n  );\n}\n\n// Main app content that lives inside the Router (so it can use useLocation)\nfunction AppContent() {\n  const { user } = useAuth();\n  const location = useLocation();\n\n  const role = (user?.role || \"\").toLowerCase();\n\n  // Hide navbar on auth pages and for admin users\n  const isAuthPage =\n    location.pathname === \"/login\" || location.pathname === \"/register\";\n  const showCustomerNavbar = user && role === \"customer\" && !isAuthPage;\n\n  console.log(\"Current user role in App:\", user?.role, \"normalized:\", role, \"path:\", location.pathname);\n\n  return (\n    <>\n      {showCustomerNavbar && <Navbar />}\n\n      <Routes>\n        {/* Public routes */}\n        <Route element={<PublicRoute />}>\n          <Route path=\"/login\" element={<Login />} />\n          <Route path=\"/register\" element={<Register />} />\n        </Route>\n\n        {/* Admin routes */}\n        <Route element={<AdminRoute />}>\n          <Route path=\"/admin/dashboard\" element={<AdminDashboard />} />\n          <Route path=\"/admin/products\" element={<AdminProducts />} />\n        </Route>\n\n        {/* Customer routes */}\n        <Route element={<CustomerRoute />}>\n          <Route path=\"/\" element={<Home />} />\n          <Route path=\"/home\" element={<Home />} />\n          <Route path=\"/products\" element={<Products />} />\n          <Route path=\"/checkout\" element={<Checkout />} />\n          <Route path=\"/orders\" element={<Orders />} />\n          <Route path=\"/notifications\" element={<Notifications />} />\n          <Route path=\"/profile\" element={<Profile />} />\n        </Route>\n\n        {/* Fallback: redirect all unknown routes */}\n        <Route\n          path=\"*\"\n          element={\n            user\n              ? user.role === \"admin\"\n                ? <Navigate to=\"/admin/dashboard\" replace />\n                : <Navigate to=\"/\" replace />\n              : <Navigate to=\"/login\" replace />\n          }\n        />\n      </Routes>\n    </>\n  );\n}\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}